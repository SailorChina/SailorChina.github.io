<!DOCTYPE html><html lang="zh-Hans"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="机场搭建"><meta name="keywords" content="机场搭建,SSRPANEL,锐速"><meta name="author" content="毓头吃芋头"><meta name="copyright" content="毓头吃芋头"><title>机场搭建 | 毓头的折腾事</title><link rel="shortcut icon" href="/img/5.jpg"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  }
} </script></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-安装内核"><span class="toc-number">1.</span> <span class="toc-text">1.安装内核</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-安装锐速破解版"><span class="toc-number">2.</span> <span class="toc-text">2.安装锐速破解版</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-安装ssrpanel前端"><span class="toc-number">3.</span> <span class="toc-text">3.安装ssrpanel前端</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/1.jpg"></div><div class="author-info__name text-center">毓头吃芋头</div><div class="author-info__description text-center">并不是我喜欢折腾这些玩意，而是“穷”把我折腾得这么疲惫</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">7</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">22</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">分类</span><span class="pull-right">15</span></a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(/img/2.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">毓头的折腾事</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">首页</a><a class="site-page" href="/archives">档案室</a><a class="site-page" href="/tags">标签</a><a class="site-page" href="/categories">分类</a></span></div><div id="post-info"><div id="post-title">机场搭建</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-05-22</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/机场搭建/">机场搭建</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/机场搭建/SSRPANEL/">SSRPANEL</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/机场搭建/SSRPANEL/锐速/">锐速</a></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h1 id="1-安装内核"><a href="#1-安装内核" class="headerlink" title="1.安装内核"></a>1.安装内核</h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">wget -N --no-check-certificate &quot;https://raw.githubusercontent.com/SailorChina/Lotseverbbr/master/tcp.sh&quot; &amp;&amp; chmod +x tcp.sh &amp;&amp; ./tcp.sh</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="2-安装锐速破解版"><a href="#2-安装锐速破解版" class="headerlink" title="2.安装锐速破解版"></a>2.安装锐速破解版</h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">wget -N --no-check-certificate https://raw.githubusercontent.com/SailorChina/serverspeeder/master/serverspeeder.sh &amp;&amp; bash serverspeeder.sh</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="3-安装ssrpanel前端"><a href="#3-安装ssrpanel前端" class="headerlink" title="3.安装ssrpanel前端"></a>3.安装ssrpanel前端</h1><p>新版脚本有以下特性：</p>
<p>商业版面板适用于CentOS 6~7（包括redhat）、Debian 8、Ubuntu 16的64位。<br>一键搭建sspanel 或 ssrpanel [整合两个面板]<br>附带管理工具及修改工具<br>后续版本将添加一机多节点功能、节点一键对接V2ray等更多新功能<br>经测试在 阿里云, 腾讯云，华为云，京东云，vultr，快云服务器上通过<br>宝塔对接搭建教程：</p>
<p>请使用宝塔5.9稳定版搭建：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">yum install -y wget &amp;&amp; wget -O install.sh http://download.bt.cn/install/install.sh &amp;&amp; sh install.sh</span><br></pre></td></tr></table></figure>
<p>For sspanel:</p>
<p>1.安装宝塔面面板，PHP版本选择7.1，数据库选择mysql5.6, 其他默认，使用Nginx环境。</p>
<p>2.新建站点，记住域名[请保持目录为域名的状态,如域名为<a href="http://www.baidu.com，目录务必为www/wwwroot/www.baidu.com]。" target="_blank" rel="noopener">www.baidu.com，目录务必为www/wwwroot/www.baidu.com]。</a></p>
<p>3.新建数据库sspanel，记住数据库用户和密码，（宝塔面板默认数据库名=用户名），如果不是sspanel请自己设置为sspanel。</p>
<p>4.运行对接脚本,选择sspanel for bt，搭建sspanel</p>
<p>5.登录后台测试(默认账号<a href="mailto:marisn@67cc.cn" target="_blank" rel="noopener">marisn@67cc.cn</a> 密码marisn)</p>
<p>6.若登录无反应，请查看网站目录/config/.config.php配置文件中的数据库配置是否正确</p>
<p>7.设置监控，打开xshell运行crontab -e,此处使用的是vi命令(不会的请百度),设置以下代码,<br>请将其中的/data/wwwroot/default更改为你的网站目录</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">0 0 * * * php -n /data/wwwroot/default/xcat dailyjob</span><br><span class="line">*/1 * * * * php /data/wwwroot/default/xcat checkjob</span><br><span class="line">*/1 * * * * php /data/wwwroot/default/xcat syncnode</span><br><span class="line">30 22 * * * php /data/wwwroot/default/xcat sendDiaryMail</span><br></pre></td></tr></table></figure>
<p>For ssrpanel:</p>
<p>1.安装宝塔面面板，PHP版本选择7.1，数据库选择mysql5.6, 其他默认，使用Nginx环境。</p>
<p>2.新建站点，记住域名[请保持目录为域名的状态,如域名为<a href="http://www.baidu.com，目录务必为www/wwwroot/www.baidu.com]。" target="_blank" rel="noopener">www.baidu.com，目录务必为www/wwwroot/www.baidu.com]。</a></p>
<p>3.新建数据库ssrpanel，记住数据库用户和密码，（宝塔面板默认数据库名=用户名），如果不是ssrpanel请自己设置为ssrpanel。</p>
<p>4.运行对接脚本,选择ssrpanel for bt，搭建ssrpanel</p>
<p>5.登录后台测试(默认账号admin 密码123456)</p>
<p>6.若登录无反应，请查看网站目录/.env配置文件中的数据库配置是否正确</p>
<p>7.设置监控，打开xshell运行crontab -e,此处使用的是vi命令(不会的请百度),设置以下代码,<br>请将其中的/data/wwwroot/default更改为你的网站目录</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">* * * * * php /data/wwwroot/default/artisan schedule:run &gt;&gt; /dev/null 2&gt;&amp;1</span><br></pre></td></tr></table></figure>
<ul>
<li><p>一键安装（免费稳定包）</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">wget --no-check-certificate https://raw.githubusercontent.com/SailorChina/ssrpanel-master/master/stable-script.sh&amp;&amp;chmod +x stable-script.sh&amp;&amp;bash stable-script.sh</span><br></pre></td></tr></table></figure>
</li>
<li><p>一键安装（测试版）</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">wget --no-check-certificate https://raw.githubusercontent.com/SailorChina/ssrpanel-master/master/dev-script.sh&amp;&amp;chmod +x dev-script.sh&amp;&amp;bash dev-script.sh</span><br></pre></td></tr></table></figure>
</li>
<li><p>一键安装（十一付费）</p>
<figure class="highlight plain"><figcaption><span>-y install wget && wget -N --no-check-certificate</span><a href="https://raw.githubusercontent.com/marisn2017/Commercial-version/master/script.sh" target="_blank" rel="noopener">&& chmod +x script.sh && ./script.sh```</a></figcaption><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">#4.后端对接</span><br><span class="line">- sspanel(API对接)</span><br></pre></td></tr></table></figure>
<p>wget -N –no-check-certificate <a href="https://raw.githubusercontent.com/SailorChina/SS-PANEL-API/master/node.sh" target="_blank" rel="noopener">https://raw.githubusercontent.com/SailorChina/SS-PANEL-API/master/node.sh</a> &amp;&amp; chmod +x node.sh  &amp;&amp; ./node.sh<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">或</span><br></pre></td></tr></table></figure></p>
</li>
</ul>
<p>wget -N –no-check-certificate <a href="https://raw.githubusercontent.com/SailorChina/ss-panel-v3-mod_Uim-master/master/node.sh" target="_blank" rel="noopener">https://raw.githubusercontent.com/SailorChina/ss-panel-v3-mod_Uim-master/master/node.sh</a> &amp;&amp; chmod +x node.sh &amp;&amp; ./node.sh<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1. 加了个简易守护程序和开机自启 如果是centos7,应该稳定不断的(每5分钟监控，也可能掉线五分钟)</span><br><span class="line"></span><br><span class="line">- ssrpanel(API对接)</span><br><span class="line"></span><br><span class="line"># 和前端一样</span><br><span class="line"></span><br><span class="line"># 其他</span><br><span class="line"></span><br><span class="line">出现500错误</span><br><span class="line">理论上操作到上面那些步骤完了应该是可以正常访问网站了，如果网站出现500错误，请看WIKI，很有可能是fastcgi的错误</span><br><span class="line"></span><br><span class="line">请看WIKI：https://github.com/ssrpanel/ssrpanel/wiki/%E5%87%BA%E7%8E%B0-open_basedir%E9%94%99%E8%AF%AF</span><br><span class="line"></span><br><span class="line">修改完记得重启NGINX和PHP-FPM</span><br><span class="line"></span><br><span class="line">重启NGINX和PHP-FPM</span><br></pre></td></tr></table></figure></p>
<p>service nginx restart<br>service php-fpm restart<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">定时任务（发邮件、流量统计、自动任务全部需要用到）【脚本已经自动添加】</span><br><span class="line"></span><br><span class="line">crontab加入如下命令（请自行修改ssrpanel路径）：</span><br><span class="line">（表示每分钟都执行定时任务，具体什么任务什么时候执行程序里已经定义了，请不要乱改，否则流量统计数据可能出错）</span><br></pre></td></tr></table></figure></p>
<ul>
<li><ul>
<li><ul>
<li><ul>
<li><ul>
<li>php /home/wwwroot/default/artisan schedule:run &gt;&gt; /dev/null 2&gt;&amp;1<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">邮件配置</span><br><span class="line">SMTP：</span><br><span class="line"></span><br><span class="line">编辑 .env 文件，修改 MAIL_ 开头的配置</span><br><span class="line">Mailgun：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">编辑 .env 文件</span><br><span class="line">将 MAIL_DRIVER 值改为 mailgun</span><br><span class="line"></span><br><span class="line">然后编辑 config/services.php</span><br><span class="line"></span><br><span class="line">请自行配置如下内容</span><br><span class="line">&apos;mailgun&apos; =&gt; [</span><br><span class="line">    &apos;domain&apos; =&gt; &apos;mailgun发件域名&apos;,</span><br><span class="line">    &apos;secret&apos; =&gt; &apos;mailgun上申请到的secret&apos;,</span><br><span class="line">],</span><br><span class="line">发邮件失败处理：</span><br><span class="line"></span><br><span class="line">如果使用了逗比的ban_iptables.sh来防止用户发垃圾邮件</span><br><span class="line">可能会导致出现 Connection could not be established with host smtp.exmail.qq.com [Connection timed out #110] 这样的错误</span><br><span class="line">因为smtp发邮件必须用到25,26,465,587这四个端口，逗比的一键脚本会将这些端口一并封禁</span><br><span class="line">可以编辑iptables，注释掉以下这段（前面加个#号就可以），然后保存并重启iptables</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>#-A OUTPUT -p tcp -m multiport –dports 25,26,465,587 -m state –state NEW,ESTABLISHED -j REJECT –reject-with icmp-port-unreachable<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">英文版</span><br><span class="line"></span><br><span class="line">修改 .env 的 APP_LOCALE 值为 en</span><br><span class="line">语言包位于 resources/lang 下，可自行更改</span><br><span class="line"></span><br><span class="line">单端口多用户（推荐）</span><br><span class="line"></span><br><span class="line">编辑节点的 user-config.json 文件：</span><br><span class="line">vim user-config.json</span><br><span class="line"></span><br><span class="line">将 “additional_ports” : &#123;&#125;, 改为以下内容：</span><br></pre></td></tr></table></figure></p>
<p>“additional_ports” : {<br>    “80”: {<br>        “passwd”: “统一认证密码”, // 例如 SSRP4ne1，推荐不要出现除大小写字母数字以外的任何字符<br>        “method”: “统一认证加密方式”, // 例如 aes-128-ctr<br>        “protocol”: “统一认证协议”, // 可选值：orgin、verify_deflate、auth_sha1_v4、auth_aes128_md5（推荐）、auth_aes128_sha1（推荐）、auth_chain_a（强烈推荐）<br>        “protocol_param”: “#”,<br>        “obfs”: “tls1.2_ticket_auth”, // 可选值：plain、http_simple（该值下客户端可用http_post）、random_head、tls1.2_ticket_auth（强烈推荐）<br>        “obfs_param”: “”<br>    },<br>    “443”: {<br>        “passwd”: “统一认证密码”,<br>        “method”: “统一认证加密方式”,<br>        “protocol”: “统一认证协议”,<br>        “protocol_param”: “#”,<br>        “obfs”: “tls1.2_ticket_auth”,<br>        “obfs_param”: “”<br>    }<br>}<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">保存，然后重启SSR服务。</span><br><span class="line">客户端设置：</span><br></pre></td></tr></table></figure></p>
<p>远程端口：80<br>密码：password<br>加密方式：aes-128-ctr<br>协议：auth_aes128_md5<br>混淆插件：tls1.2_ticket_auth<br>协议参数：1026:@123 (SSR端口:SSR密码)<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">或</span><br></pre></td></tr></table></figure></p>
<p>远程端口：443<br>密码：password<br>加密方式：aes-128-ctr<br>协议：auth_aes128_sha1<br>混淆插件：tls1.2_ticket_auth<br>协议参数：1026:SSRP4ne1 (SSR端口:SSR密码)<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">经实测，节点后端使用auth_sha1_v4_compatible，可以兼容auth_chain_a</span><br><span class="line">注意：如果想强制所有账号都走80、443这样自定义的端口的话，记得把 user-config.json 中的 additional_ports_only 设置为 true</span><br><span class="line">警告：经实测单端口下如果用锐速没有效果，很可能是VPS供应商限制了这两个端口</span><br><span class="line">提示：配置单端口最好先看下这个WIKI，防止才踩坑：https://github.com/ssrpanel/ssrpanel/wiki/%E5%8D%95%E7%AB%AF%E5%8F%A3%E5%A4%9A%E7%94%A8%E6%88%B7%E7%9A%84%E5%9D%91</span><br><span class="line"></span><br><span class="line">校时</span><br><span class="line">如果架构是“面板机-数据库机-多节点机”，请务必保持各个服务器之间的时间一致，否则会产生：节点的在线数不准确、产生最后使用时间异常、单端口多用户功能失效等。</span><br><span class="line">推荐统一使用CST时间并安装校时服务：</span><br></pre></td></tr></table></figure></p>
<p>vim /etc/sysconfig/clock 把值改为 Asia/Shanghai<br>cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">重启一下服务器，然后：</span><br></pre></td></tr></table></figure></p>
<p>yum install ntp<br>ntpdate cn.pool.ntp.org<br><code>`</code></p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">毓头吃芋头</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://sailorchina.coding.me/2019/03/23/机场搭建/">http://sailorchina.coding.me/2019/03/23/机场搭建/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://sailorchina.coding.me">毓头的折腾事</a>！</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/机场搭建/">机场搭建</a><a class="post-meta__tags" href="/tags/SSRPANEL/">SSRPANEL</a><a class="post-meta__tags" href="/tags/锐速/">锐速</a></div><div class="post-qr-code"><div class="post-qr-code-item"><img class="post-qr-code__img" src="/img/微信名片.png"><div class="post-qr-code__desc">微信名片</div></div><div class="post-qr-code-item"><img class="post-qr-code__img" src="/img/比特币钱包.jpg"><div class="post-qr-code__desc">比特币打赏</div></div><div class="post-qr-code-item"><img class="post-qr-code__img" src="/img/wechat.png"><div class="post-qr-code__desc">微信打赏</div></div><div class="post-qr-code-item"><img class="post-qr-code__img" src="/img/alipay.png"><div class="post-qr-code__desc">支付宝打赏</div></div></div><div class="social-share"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script><nav id="pagination"><div class="prev-post pull-left"><a href="/2019/03/23/hexo之next主题添加标签/"><i class="fa fa-chevron-left">  </i><span>Hexo之Next主题添加标签</span></a></div></nav><div class="post-adv"><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="530" height="86" src="//music.163.com/outchain/player?type=2&id=1878854&auto=1&height=66"></iframe></div><div id="vcomment"></div><script src="https://cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var notify = 'true' == true ? true : false;
var verify = 'false' == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;
window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'7VGQEYfisYj098V2aqpXQVLj-gzGzoHsz',
  appKey:'jB9qBEF1sNjzNEyTTYrpB5Xb',
  placeholder:'能不能给我点个“赏”，谢谢您对我的支持，请留言',
  avatar:'retro',
  guest_info:guest_info,
  pageSize:'10',
  lang: 'zh-cn'
})</script></div></div><footer class="footer-bg" style="background-image: url(/img/2.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2019 By 毓头吃芋头</div><div class="framework-info"><span>驱动 - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script>if(/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
}</script></body></html>